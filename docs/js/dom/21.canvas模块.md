## å¿«é€Ÿå¼€å§‹

[canvas](https://developer.mozilla.org/zh-CN/docs/Web/HTML/Reference/Elements/canvas) æ˜¯ H5 æ–°å¢åŠ çš„æ ‡ç­¾
æˆ‘ä»¬å¯ä»¥é€šè¿‡ JavaScript Canvas API(2D) æˆ– WebGL API(3D) ç»˜åˆ¶å›¾å½¢åŠå›¾å½¢åŠ¨ç”», ç°é˜¶æ®µä¸»è¦å­¦ä¹  2D ç›¸å…³ API

- [HTMLCanvasElement](https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLCanvasElement)
- [CanvasRenderingContext2D](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D)
- [CanvasGradient](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasGradient)
- [CanvasPattern](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasPattern)

::: code-group

```html
<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="referrer" content="no-referrer" />
    <title>Canvas and SVG</title>
    <style>
      * {
        margin: 0;
        padding: 0;
      }
      body {
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        padding: 20px;
      }
      #app {
        border: 1px solid #f00;
      }
    </style>
  </head>
  <body>
    <canvas id="app">Your browser does not support the canvas element.</canvas>
    <script src="./index.js" type="module"></script>
  </body>
</html>
```

```js
window.onload = function () {
  const canvasDom = document.getElementById("app");

  // 2d:   canvas API æ˜¯ CanvasRenderingContext2D ç±»çš„å®ä¾‹
  // webgl: webgl API æ˜¯ WebGLRenderingContext    ç±»çš„å®ä¾‹
  // åŠ ä¸Šæ³¨é‡Šå¯ä»¥è®©ç¼–è¾‘å™¨æ˜¾ç¤ºä»£ç æç¤º
  /** @type {CanvasRenderingContext2D} */
  const ctx = canvasDom.getContext("2d");
  console.log(ctx instanceof CanvasRenderingContext2D); // true

  // è®¾ç½®å®½é«˜å±æ€§
  // æ³¨æ„äº†: è¿™æ˜¯è®¾ç½® canvasDom çš„å±æ€§, è€Œä¸æ˜¯æ ·å¼
  // è¿™ä¸ªdomå¯¹è±¡æ˜¯ HTMLCanvasElement ç±»çš„å®ä¾‹, å®ƒæœ¬èº«å°±æœ‰
  // width å’Œ height å±æ€§, ä½†æ˜¯å®ƒä¸æ˜¯ style çš„å±æ€§
  canvasDom.width = window.innerWidth;
  canvasDom.height = window.clientHeight;
  console.log(ctx.canvas instanceof HTMLCanvasElement); // true
};
```

:::

## å¿«é€Ÿå¼€å§‹:ä½“éªŒç”¨ä»£ç ç”»å›¾

- [moveTo](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/moveTo)
- [lineTo](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/lineTo)
- [stroke](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/stroke)

```js
window.onload = function () {
  function initCanvasDom() {
    const canvasDom = document.getElementById("app");
    canvasDom.width = window.innerWidth;
    canvasDom.height = window.innerHeight;
    return canvasDom;
  }

  // 0. åˆå§‹åŒ–dom & è·å– canvasä¸Šä¸‹æ–‡
  const canvasDom = initCanvasDom();
  const ctx = canvasDom.getContext("2d");

  // 1.å°† "ç”»ç¬”" æ”¾åˆ°æŒ‡å®šçš„ä½ç½®
  ctx.moveTo(50, 50);

  // 2.ç”¨ "ç”»ç¬”" ç”»ä¸€æ¡çº¿åˆ°æŒ‡å®šçš„ä½ç½®
  ctx.lineTo(100, 50);

  ctx.stroke();
};
```

## æ€è€ƒ ğŸ¤”

> ä¸ºä»€ä¹ˆä¸åº”è¯¥ç”¨ css çš„æ–¹å¼å»è®¾ç½® canvas çš„å®½åº¦å’Œé«˜åº¦

æ³¨æ„æˆ‘è¯´åˆ°çš„æ˜¯ `ä¸åº”è¯¥` è€Œé `ä¸å¯ä»¥`, å®é™…ä¸Šæ˜¯å¯ä»¥é€šè¿‡ css, å»å¼ºè¡Œæ”¹å˜
canvas å…ƒç´ æ˜¾ç¤ºçš„å®½åº¦å’Œé«˜åº¦çš„, æ—¢ç„¶å¯ä»¥æ”¹å˜é‚£ä¸ºä»€ä¹ˆä¸åº”è¯¥ä½¿ç”¨ css è®¾ç½®å®½é«˜å‘¢?
ç©¶å…¶åŸå› : ä¸»è¦æ˜¯å› ä¸º `canvas` å…ƒç´ æœ‰ 2 ä¸ªå°ºå¯¸

1. å†…åœ¨å°ºå¯¸: æˆ–è€…å«ç»˜å›¾çš„ç¼“å†²åŒºå°ºå¯¸, å¯ä»¥é€šè¿‡ `HTMLCanvasElement` ç±»çš„ `width` å’Œ `height` å±æ€§æ¥è®¾ç½®
2. æ˜¾ç¤ºå°ºå¯¸: å±•ç¤ºåœ¨æµè§ˆå™¨ä¸­çš„å°ºå¯¸, é»˜è®¤æƒ…å†µä¸‹, æ˜¯å’Œ `HTMLCanvasElement` ç±»çš„ `width` å’Œ `height` ç›¸åŒ, å¦‚æœéè¦ä¸åŒå°±ä¼šæ‹‰ä¼¸/ç¼©æ”¾

::: code-group

```js
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 200;
    canvasDom.height = 200;
    return canvasDom;
  }

  function drawLine(canvasDom) {
    const ctx = canvasDom.getContext("2d");
    ctx.moveTo(50, 50);
    ctx.lineTo(100, 50);
    ctx.stroke();
  }

  drawLine(initCanvasDom("app"));
  drawLine(initCanvasDom("app2"));
};
```

```html{25,26}
<!doctype html>
<html lang="zh-cn">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="referrer" content="no-referrer" />
    <title>Canvas and SVG</title>
    <style>
      * {
        margin: 0;
        padding: 0;
      }
      body {
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        padding: 20px;
      }
      #app {
        background: #f00;
      }
      #app2 {
        background: #f00;
        width: 400px;
        height: 400px;
      }
    </style>
  </head>
  <body>
    <canvas id="app">Your browser does not support the canvas element.</canvas>
    <canvas id="app2">Your browser does not support the canvas element.</canvas>
    <script src="./index.js" type="module"></script>
  </body>
</html>
```

:::

![diff](https://raw.githubusercontent.com/liaohui5/images/main/images/202511181608619.png)

## ç”»çº¿æ¡

### ç»˜åˆ¶çº¿æ¡å¹¶è®¾ç½®æ ·å¼

- [lineWidth](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/lineWidth)
- [lineCap](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/lineCap)
- [lineJoin](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/lineJoin)
- [strokeStyle](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/strokeStyle)

```js
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 500;
    canvasDom.height = 500;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");
  const ctx = canvasDom.getContext("2d");

  // è®¾ç½®çº¿æ¡çš„ç²—ç»†(é«˜åº¦)
  ctx.lineWidth = 10;

  // è®¾ç½®çº¿æ¡çš„æ ·å¼
  ctx.strokeStyle = "#f00";

  // è®¾ç½®çº¿æ¡ä¸¤ç«¯çš„æ ·å¼
  ctx.lineCap = "round"; // butt(é»˜è®¤)/round/square

  // è®¾ç½®çº¿æ¡é“¾æ¥å¤„çš„æ ·å¼(éœ€è¦ä¸¤æ¡çº¿æ‰èƒ½çœ‹å‡ºæ•ˆæœæ¥)
  ctx.lineJoin = "round"; // miter(é»˜è®¤)/round/bevel

  ctx.moveTo(50, 50);
  ctx.lineTo(200, 50);
  ctx.stroke();
};
```

![lin-style](https://raw.githubusercontent.com/liaohui5/images/main/images/202511181634877.png)

### ç»˜åˆ¶å¤šä¸ªçº¿æ¡

- [beginPath](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/beginPath)

```js {20-23}
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 500;
    canvasDom.height = 500;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");
  const ctx = canvasDom.getContext("2d");

  // line1
  ctx.moveTo(50, 50);
  ctx.lineTo(200, 50);
  ctx.lineWidth = 10;
  ctx.strokeStyle = "#f00";
  ctx.stroke();

  // line2
  // å¦‚æœæ²¡æœ‰è°ƒç”¨ beginPath å¼€å¯æ–°çš„ç»˜åˆ¶è·¯å¾„(æ‹¿èµ·å¦å¤–ä¸€æ”¯ç¬”)
  // é‚£ä¹ˆå‰é¢ line1 çš„æ ·å¼ä¼šè¢«åé¢è®¾ç½®çš„æ ·å¼ç»™è¦†ç›–æ‰
  // å› æ­¤ä¸ºäº†é¿å…å½±å“, åº”è¯¥æ¯æ¬¡åˆ’çº¿ä¹‹å‰æ‹¿èµ·æ–°çš„ä¸€æ”¯ç¬”(è°ƒç”¨: beginPath)
  ctx.beginPath();
  ctx.moveTo(50, 100);
  ctx.lineTo(300, 100);
  ctx.lineWidth = 20;
  ctx.strokeStyle = "#0f0";
  ctx.stroke();
};
```

### åˆ©ç”¨çº¿æ¡ç»˜åˆ¶ä¸€äº›ç®€å•å›¾å½¢

```js
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 500;
    canvasDom.height = 500;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");
  const ctx = canvasDom.getContext("2d");

  function drawLines(startPos = { x: 0, y: 0 }, linesPos = [], lineColor = "#f00", lineWidth = 10) {
    ctx.beginPath();
    ctx.moveTo(startPos.x, startPos.y);

    for (let i = 0; i < linesPos.length; i++) {
      const linePos = linesPos[i];
      ctx.lineTo(linePos.x, linePos.y);
    }

    ctx.strokeStyle = lineColor;
    ctx.lineWidth = lineWidth;
    ctx.stroke();
  }

  // ä¸‰è§’å½¢
  drawLines({ x: 100, y: 100 }, [
    { x: 100, y: 200 },
    { x: 200, y: 200 },
    // é»˜è®¤æƒ…å†µä¸‹ä¸ä¼šä»æœ€åä¸€ä¸ªç‚¹é“¾æ¥åˆ°ç¬¬ä¸€ä¸ªç‚¹,
    // æ‰€ä»¥éœ€è¦æœ€åä¸€ä¸ªç‚¹å’Œç¬¬ä¸€ä¸ªç‚¹ä½ç½®ä¸€æ ·,è¿™æ ·æ‰èƒ½é—­åˆ
    { x: 100, y: 100 },
  ]);

  // æ­£æ–¹å½¢
  drawLines({ x: 100, y: 300 }, [
    { x: 200, y: 300 },
    { x: 200, y: 400 },
    { x: 100, y: 400 },
    { x: 100, y: 300 },
  ]);
};
```

![preview](https://raw.githubusercontent.com/liaohui5/images/main/images/202511181707615.png)

ç”±ä¸Šå›¾å¯ä»¥å‘ç°, åˆ©ç”¨æœ€åä¸€ä¸ªç‚¹å’Œç¬¬ä¸€ä¸ªç‚¹é‡åˆçš„æ–¹å¼é—­åˆåˆ’çº¿çš„æ–¹å¼, ä¼šè®©è¿æ¥å¤„å‡ºç° "ç‘•ç–µ"

é‚£æœ‰æ²¡æœ‰åŠæ³•å¯ä»¥é¿å…è¿™ä¸ª "ç‘•ç–µ" å‘¢? è®©æœ€åä¸€ä¸ªç‚¹è‡ªåŠ¨è¿æ¥åˆ°èµ·å§‹ç‚¹

### é—­åˆè·¯å¾„

- [closePath](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/closePath)

```js {21-22,33-35,43}
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 500;
    canvasDom.height = 500;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");
  const ctx = canvasDom.getContext("2d");

  function drawLines(startPos = { x: 0, y: 0 }, linesPos = [], lineColor = "#f00", lineWidth = 10) {
    ctx.beginPath();
    ctx.moveTo(startPos.x, startPos.y);

    for (let i = 0; i < linesPos.length; i++) {
      const linePos = linesPos[i];
      ctx.lineTo(linePos.x, linePos.y);
    }

    // é—­åˆè·¯å¾„:è®©æœ€åä¸€ä¸ªç‚¹è‡ªåŠ¨è¿æ¥åˆ°èµ·å§‹ç‚¹
    ctx.closePath();

    ctx.strokeStyle = lineColor;
    ctx.lineWidth = lineWidth;
    ctx.stroke();
  }

  // ä¸‰è§’å½¢
  drawLines({ x: 100, y: 100 }, [
    { x: 100, y: 200 },
    { x: 200, y: 200 },
    // é»˜è®¤æƒ…å†µä¸‹ä¸ä¼šä»æœ€åä¸€ä¸ªç‚¹é“¾æ¥åˆ°ç¬¬ä¸€ä¸ªç‚¹,
    // æ‰€ä»¥éœ€è¦æœ€åä¸€ä¸ªç‚¹å’Œç¬¬ä¸€ä¸ªç‚¹ä½ç½®ä¸€æ ·,è¿™æ ·æ‰èƒ½é—­åˆ
    // { x: 100, y: 100 },
  ]);

  // æ­£æ–¹å½¢
  drawLines({ x: 100, y: 300 }, [
    { x: 200, y: 300 },
    { x: 200, y: 400 },
    { x: 100, y: 400 },
    // { x: 100, y: 300 },
  ]);
};
```

### ç»˜åˆ¶è™šçº¿

- [setLineDash](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/setLineDash)
- [getLineDash](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/getLineDash)
- [lineDashOffset](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/lineDashOffset)

```js
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 500;
    canvasDom.height = 500;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");
  const ctx = canvasDom.getContext("2d");

  function drawLine(startPos = { x: 0, y: 0 }, dashes = [5]) {
    ctx.beginPath();
    ctx.moveTo(startPos.x, startPos.y);
    ctx.lineTo(startPos.x + 300, startPos.y);
    ctx.strokeStyle = "red";
    ctx.lineWidth = 10;
    ctx.setLineDash(dashes);
    ctx.stroke();
  }

  drawLine({ x: 100, y: 150 }, [5]);
  console.log("lineDash-1", ctx.getLineDash());
  // [5, 5]

  drawLine({ x: 100, y: 250 }, [5, 10]);
  console.log("lineDash-2", ctx.getLineDash());
  // [5, 10]

  drawLine({ x: 100, y: 300 }, [5, 10, 15]);
  console.log("lineDash-3", ctx.getLineDash());
  // [5, 10, 15, 5, 10, 15]

  drawLine({ x: 100, y: 350 }, [5, 10, 15, 20]);
  console.log("lineDash-4", ctx.getLineDash());
  // [5, 10, 15, 20]
};
```

![dash](https://raw.githubusercontent.com/liaohui5/images/main/images/202511181905610.png)

## å¡«å……å›¾å½¢

- [fillStyle](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/fillStyle)
- [fill](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/fill)

```js
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 500;
    canvasDom.height = 500;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");
  const ctx = canvasDom.getContext("2d");

  function drawRect(positionArray = [], color = "#f00") {
    if (positionArray.length < 3) {
      return;
    }
    const [startPos, ...linesPos] = positionArray;
    ctx.beginPath();
    ctx.moveTo(startPos.x, startPos.y);
    for (let i = 0; i < linesPos.length; i++) {
      const item = linesPos[i];
      ctx.lineTo(item.x, item.y);
    }
    ctx.closePath();

    ctx.strokeStyle = color;
    ctx.lineWidth = 10;
    ctx.stroke();

    // è®¾ç½®å¡«å……é¢œè‰²å¹¶ä¸”å¡«å……
    ctx.fillStyle = color;
    ctx.fill();
  }

  drawRect([
    { x: 100, y: 100 },
    { x: 300, y: 100 },
    { x: 300, y: 300 },
    { x: 100, y: 300 },
  ]);
};
```

### éé›¶ç¯ç»•åŸåˆ™

::: danger æ³¨æ„
åªæœ‰åœ¨åŒä¸€æ¡è·¯å¾„è·¯å¾„ä¸­æ‰ä¼šéµå®ˆè¿™ä¸ªç»˜åˆ¶åŸåˆ™, å¦‚æœæ˜¯ä¸åŒçš„è·¯å¾„æ²¡æœ‰è¿™ä¸ªè§„åˆ™çš„å½±å“
:::

1. æ¯æ¬¡å¡«å……å‰ä»å›¾å½¢çš„ä¸­å¿ƒæ‹‰å‡ºä¸€æ¡çº¿, çœ‹è·¯å¾„ä¸Šä¸ä¹‹ç›¸äº¤çš„ç‚¹æ˜¯é¡ºæ—¶é’ˆè¿˜æ˜¯é€†æ—¶é’ˆ
2. é»˜è®¤ `x = 0` å¦‚æœæ˜¯é€†æ—¶é’ˆé‚£ä¹ˆ `x + 1`, å¦‚æœæ˜¯é¡ºæ—¶é’ˆé‚£ä¹ˆ `x - 1`
3. æœ€åå¦‚æœ `x = 0`, å°±ä¸ä¼šå¡«å……, å¦‚æœç»“æœéé›¶é‚£ä¹ˆå°±ä¼šå¡«å……

æ³¨: è¿™ä¸ªè§„åˆ™ä¸­çš„ x æ˜¯è¡¨ç¤ºä¸€ä¸ªæœªçŸ¥æ•°, ä¸æ˜¯åæ ‡ä½ç½®çš„æ„æ€

::: code-group

```js {20-24,50-54}
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 500;
    canvasDom.height = 500;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");
  const ctx = canvasDom.getContext("2d");

  // å¤§çš„çŸ©å½¢æ˜¯é¡ºæ—¶é’ˆ, æ‰€ä»¥: x += 1
  ctx.moveTo(100, 100);
  ctx.lineTo(300, 100);
  ctx.lineTo(300, 300);
  ctx.lineTo(100, 300);
  ctx.closePath();

  // å°çš„çŸ©å½¢ä¹Ÿæ˜¯é¡ºæ—¶é’ˆ x += 1
  ctx.moveTo(150, 150);
  ctx.lineTo(250, 150);
  ctx.lineTo(250, 250);
  ctx.lineTo(150, 250);
  ctx.closePath();

  // æ³¨: æˆ‘åª stroke ç»˜åˆ¶äº†ä¸€æ¬¡, ä¸”æ˜¯åŒä¸€ä¸ª path
  const fillColor = "#f00";
  ctx.strokeStyle = fillColor;
  ctx.lineWidth = 10;
  ctx.fillStyle = fillColor;
  ctx.stroke();
  ctx.fill();

  // æœ€å: å¤§çŸ©å½¢çš„ x = 1, å°çŸ©å½¢çš„ x = 2, æ‰€ä»¥éƒ½ä¼šå¡«å……

  ///////////////////////////////////////////////////////
  // è¿™æ˜¯ç¬¬äºŒä¸ª canvas, æ³¨æ„å¯¹æ¯”: å°çŸ©å½¢çš„ç»˜åˆ¶é¡ºåºä¸åŒ //
  ///////////////////////////////////////////////////////
  const canvasDom2 = initCanvasDom("app2");
  const ctx2 = canvasDom2.getContext("2d");

  // å¤§çš„çŸ©å½¢æ˜¯é¡ºæ—¶é’ˆ, æ‰€ä»¥: x += 1
  ctx2.moveTo(100, 100);
  ctx2.lineTo(300, 100);
  ctx2.lineTo(300, 300);
  ctx2.lineTo(100, 300);
  ctx2.closePath();

  // å°çš„çŸ©å½¢ä¹Ÿæ˜¯é¡ºæ—¶é’ˆ, æ‰€ä»¥: x -= 1
  ctx2.moveTo(250, 150);
  ctx2.lineTo(150, 150);
  ctx2.lineTo(150, 250);
  ctx2.lineTo(250, 250);
  ctx2.closePath();

  // æ³¨: æˆ‘åª stroke ç»˜åˆ¶äº†ä¸€æ¬¡, ä¸”æ˜¯åŒä¸€ä¸ª path
  ctx2.strokeStyle = fillColor;
  ctx2.lineWidth = 10;
  ctx2.fillStyle = fillColor;
  ctx2.stroke();
  ctx2.fill();

  // æœ€å: å¤§çŸ©å½¢çš„ x = 1, å°çŸ©å½¢çš„ x = 0, æ‰€ä»¥å°çŸ©å½¢ä¸ä¼šç»˜åˆ¶
};
```

```html
<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="referrer" content="no-referrer" />
    <title>Canvas and SVG</title>
    <style>
      * {
        margin: 0;
        padding: 0;
      }
      body {
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        padding: 20px;
      }
      #app,
      #app2 {
        border: 1px solid #f00;
      }
    </style>
  </head>
  <body>
    <canvas id="app">Your browser does not support the canvas element.</canvas>
    <canvas id="app2">Your browser does not support the canvas element.</canvas>
    <script src="./index.js" type="module"></script>
  </body>
</html>
```

:::

![shun](https://raw.githubusercontent.com/liaohui5/images/main/images/202511181840779.png)
![ni](https://raw.githubusercontent.com/liaohui5/images/main/images/202511181842331.png)

æœ€åçœ‹æ•ˆæœå›¾, è¯´æ˜, ç»“è®ºæ²¡é”™:
![preview](https://raw.githubusercontent.com/liaohui5/images/main/images/202511181844030.png)

## ç»ƒä¹ :ç»˜åˆ¶æŠ˜çº¿å›¾è¡¨æ ¼

::: code-group

```js [å®ç°æ­¥éª¤]
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 500;
    canvasDom.height = 500;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");
  const ctx = canvasDom.getContext("2d");

  const gridSize = 50;
  const { width, height } = ctx.canvas;
  const rows = Math.floor(height / gridSize);
  const cols = Math.floor(width / gridSize);

  // ç»˜åˆ¶ç½‘æ ¼
  for (let i = 0; i < rows; i++) line chart{
    const y = i * gridSize - 0.5;
    ctx.beginPath();
    ctx.moveTo(0, y);
    ctx.lineTo(width, y);
    ctx.stroke();
  }

  for (let i = 0; i < cols; i++) {
    const x = i * gridSize - 0.5;
    ctx.beginPath();
    ctx.moveTo(x, 0);
    ctx.lineTo(x, height);
    ctx.stroke();
  }

  // è®¡ç®—åæ ‡ç³»èµ·ç‚¹ å’Œ ç»ˆç‚¹
  const originPos = {
    x: gridSize,line chart
    y: height - gridSize,
  };
  const targetPos = {
    x: width - gridSize,
    y: gridSize,
  };

  // ç»˜åˆ¶ x è½´
  ctx.beginPath();
  ctx.moveTo(originPos.x, originPos.y);
  ctx.lineTo(targetPos.x, originPos.y);
  ctx.strokeStyle = "#f00";
  ctx.stroke();

  // ç»˜åˆ¶xè½´ç®­å¤´line chart
  ctx.beginPath();
  ctx.lineTo(targetPos.x - 10, originPos.y - 5);
  ctx.lineTo(targetPos.x - 10, originPos.y + 5);
  ctx.lineTo(targetPos.x, originPos.y);
  ctx.closePath();
  ctx.fillStyle = "#f00";
  ctx.fill();
  ctx.stroke();

  // ç»˜åˆ¶ y è½´
  ctx.beginPath();
  ctx.moveTo(originPos.x, originPos.y);
  ctx.lineTo(originPos.x, targetPos.y);
  ctx.strokeStyle = "#f00";
  ctx.stroke();

  // ç»˜åˆ¶yè½´ç®­å¤´
  ctx.beginPath();
  ctx.lineTo(originPos.x - 5, targetPos.y + 10);
  ctx.lineTo(originPos.x + 5, targetPos.y + 10);
  ctx.lineTo(originPos.x, targetPos.y);
  ctx.closePath();
  ctx.fillStyle = "#f00";
  ctx.fill();
  ctx.stroke();

  // æ¨¡æ‹ŸæŠ˜çº¿å›¾ç‚¹çš„åæ ‡æ•°æ®
  const tableData = [
    { x: 100, y: 300 },
    { x: 200, y: 200 },
    { x: 300, y: 250 },
    { x: 400, y: 150 },
    { x: 400, y: 150 },
  ];

  // ç»˜åˆ¶æŠ˜çº¿å›¾æ‰€æœ‰çš„ç‚¹
  const dotSize = 10;
  const halfDotSize = dotSize / 2;
  for (let i = 0; i < tableData.length; i++) {
    const item = tableData[i];
    ctx.beginPath();
    ctx.moveTo(item.x - halfDotSize, item.y - halfDotSize);
    ctx.lineTo(item.x + dotSize - halfDotSize, item.y - halfDotSize);
    ctx.lineTo(item.x + dotSize - halfDotSize, item.y + dotSize - halfDotSize);
    ctx.lineTo(item.x - halfDotSize, item.y + dotSize - halfDotSize);
    ctx.closePath();
    ctx.fillStyle = "#f00";
    ctx.fill();
    ctx.strokeStyle = "#f00";
    ctx.stroke();
  }

  // ç»˜åˆ¶æŠ˜çº¿å›¾æ‰€æœ‰ç‚¹ä¹‹é—´çš„è¿çº¿
  const [start, ...dots] = tableData;
  ctx.beginPath();
  ctx.moveTo(start.x, start.y);
  ctx.lineWidth = 2;
  for (let i = 0; i < dots.length; i++) {
    const dot = dots[i];
    ctx.lineTo(dot.x, dot.y);
  }
  ctx.strokeStyle = "#f00";
  ctx.stroke();
};
```

```js [ç®€å•å°è£…]
class LineChart {
  canvasContext = null;
  constructor(width = 300, height = 300) {
    const canvasDom = document.createElement("canvas");
    canvasDom.width = width;
    canvasDom.height = height;
    this.canvasContext = canvasDom.getContext("2d");
    document.body.appendChild(canvasDom);
  }

  drawGrid(gridSize = 50) {
    const ctx = this.canvasContext;
    const { width, height } = ctx.canvas;
    const rows = Math.floor(height / gridSize);
    const cols = Math.floor(width / gridSize);

    // ç»˜åˆ¶è¡Œ
    for (let i = 0; i < rows; i++) {
      const y = i * gridSize - 0.5;
      ctx.beginPath();
      ctx.moveTo(0, y);
      ctx.lineTo(width, y);
      ctx.stroke();
    }

    // ç»˜åˆ¶åˆ—
    for (let i = 0; i < cols; i++) {
      const x = i * gridSize - 0.5;
      ctx.beginPath();
      ctx.moveTo(x, 0);
      ctx.lineTo(x, height);
      ctx.stroke();
    }
  }

  // ç»˜åˆ¶åæ ‡ç³»
  drawCoor(gridSize = 50, coorColor = "#f00") {
    const ctx = this.canvasContext;
    const { width, height } = ctx.canvas;

    // è®¡ç®—åæ ‡ç³»èµ·ç‚¹ å’Œ ç»ˆç‚¹
    const originPos = {
      x: gridSize,
      y: height - gridSize,
    };
    const targetPos = {
      x: width - gridSize,
      y: gridSize,
    };
    this.originPos = originPos;
    this.targetPos = targetPos;

    // ç»˜åˆ¶ x è½´
    ctx.beginPath();
    ctx.moveTo(originPos.x, originPos.y);
    ctx.lineTo(targetPos.x, originPos.y);
    ctx.strokeStyle = coorColor;
    ctx.stroke();

    // ç»˜åˆ¶xè½´ç®­å¤´
    ctx.beginPath();
    ctx.lineTo(targetPos.x - 10, originPos.y - 5);
    ctx.lineTo(targetPos.x - 10, originPos.y + 5);
    ctx.lineTo(targetPos.x, originPos.y);
    ctx.closePath();
    ctx.fillStyle = coorColor;
    ctx.fill();
    ctx.stroke();

    // ç»˜åˆ¶ y è½´
    ctx.beginPath();
    ctx.moveTo(originPos.x, originPos.y);
    ctx.lineTo(originPos.x, targetPos.y);
    ctx.strokeStyle = coorColor;
    ctx.stroke();

    // ç»˜åˆ¶yè½´ç®­å¤´
    ctx.beginPath();
    ctx.lineTo(originPos.x - 5, targetPos.y + 10);
    ctx.lineTo(originPos.x + 5, targetPos.y + 10);
    ctx.lineTo(originPos.x, targetPos.y);
    ctx.closePath();
    ctx.fillStyle = coorColor;
    ctx.fill();
    ctx.stroke();
  }

  // ç»˜åˆ¶æŠ˜çº¿å›¾æ‰€æœ‰çš„ç‚¹
  drawDots(tableData = [], dotSize = 10, dotColor = "#f00") {
    const ctx = this.canvasContext;
    const halfDotSize = dotSize / 2;
    for (let i = 0; i < tableData.length; i++) {
      const item = tableData[i];
      ctx.beginPath();
      ctx.moveTo(item.x - halfDotSize, item.y - halfDotSize);
      ctx.lineTo(item.x + dotSize - halfDotSize, item.y - halfDotSize);
      ctx.lineTo(item.x + dotSize - halfDotSize, item.y + dotSize - halfDotSize);
      ctx.lineTo(item.x - halfDotSize, item.y + dotSize - halfDotSize);
      ctx.closePath();
      ctx.fillStyle = dotColor;
      ctx.fill();
      ctx.strokeStyle = dotColor;
      ctx.stroke();
    }
  }

  // ç»˜åˆ¶æŠ˜çº¿å›¾æ‰€æœ‰ç‚¹ä¹‹é—´çš„è¿çº¿
  drawLines(tableData = [], lineWidth = 2, lineColor = "#f00") {
    const ctx = this.canvasContext;
    const [start, ...dots] = tableData;
    ctx.beginPath();
    ctx.moveTo(start.x, start.y);
    ctx.lineWidth = lineWidth;
    for (let i = 0; i < dots.length; i++) {
      const dot = dots[i];
      ctx.lineTo(dot.x, dot.y);
    }
    ctx.strokeStyle = lineColor;
    ctx.stroke();
  }

  // ç»˜åˆ¶æŸ±çŠ¶å›¾çŸ©å½¢(åç»­ä¼šå­¦åˆ°)
  drawBars(tableData = [], gridSize = 50, barColor = "#f00") {
    const ctx = this.canvasContext;
    for (const item of tableData) {
      ctx.fillRect(item.x, item.y, gridSize, this.originPos.y - item.y);
    }
  }
}

window.onload = function () {
  const lineChart = new LineChart(500, 500);
  lineChart.drawGrid();
  lineChart.drawCoor();

  const tableData = [
    { x: 100, y: 300 },
    { x: 200, y: 200 },
    { x: 300, y: 250 },
    { x: 400, y: 150 },
    { x: 400, y: 150 },
  ];
  lineChart.drawDots(tableData);
  lineChart.drawLines(tableData);
};
```

:::

![line-chart](https://raw.githubusercontent.com/liaohui5/images/main/images/202511182011428.png)

## ç»˜åˆ¶/æ¸…é™¤çŸ©å½¢

- [rect](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/rect)
  ç»˜åˆ¶çŸ©å½¢ä½†å¹¶ä¸ä¼šç«‹å³ stroke æˆ– fill,éœ€è¦æ‰‹åŠ¨ stroke/fill æ‰èƒ½ç»˜åˆ¶, å¹¶ä¸”è°ƒç”¨å¤šæ¬¡ä¹Ÿæ˜¯ä¸€ä¸ª Path, éœ€è¦æ‰‹åŠ¨ beginPath
- [strokeRect](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/strokeRect) ç»˜åˆ¶çŸ©å½¢å¹¶ä¸”ç«‹å³ stroke
- [fillRect](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/fillRect) ç»˜åˆ¶çŸ©å½¢å¹¶ä¸”ç«‹å³ fill
- [clearRect](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/clearRect) æ¸…é™¤çŸ©å½¢, æ¸…é™¤çŸ©å½¢å†…çš„å¡«å……é¢œè‰²å’Œçº¿æ¡ç­‰

è€… 3 ä¸ªå‡½æ•°çš„å‚æ•°éƒ½æ˜¯ä¸€æ ·çš„: `rect(x, y, width, height)`

- x: èµ·å§‹ç‚¹çš„ x åæ ‡
- y: èµ·å§‹ç‚¹çš„ y åæ ‡
- width: çŸ©å½¢çš„å®½åº¦
- height: çŸ©å½¢çš„é«˜åº¦

```js
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 500;
    canvasDom.height = 500;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");
  const ctx = canvasDom.getContext("2d");

  ctx.strokeStyle = "#f00";
  ctx.rect(10, 10, 100, 100); // è¿™ä¸ªå°±ç­‰åŒäºä¸‹é¢è¿™ 5 è¡Œä»£ç 
  // ctx.moveTo(10, 10);
  // ctx.lineTo(100, 10);
  // ctx.lineTo(100, 100);
  // ctx.lineTo(10, 100);
  // ctx.closePath();
  ctx.stroke(); // éœ€è¦æ‰‹åŠ¨ stroke/fill æ‰ä¼šç»˜åˆ¶å‡ºæ¥

  ctx.strokeStyle = "#0f0";
  ctx.strokeRect(120, 120, 100, 100); // è¿™ä¸ªä»£ç å°±ç­‰åŒäºä¸‹é¢è¿™ 7 è¡Œä»£ç 
  // ctx.beginPath();
  // ctx.moveTo(120, 120);
  // ctx.lineTo(120 + 100, 120);
  // ctx.lineTo(120 + 100, 120 + 100);
  // ctx.lineTo(120, 120 + 100);
  // ctx.closePath();
  // ctx.stroke();

  ctx.fillStyle = "#00f";
  ctx.fillRect(230, 230, 100, 100); // è¿™ä¸ªä»£ç å°±ç­‰åŒäºä¸‹é¢è¿™ 7 è¡Œä»£ç 
  // ctx.beginPath();
  // ctx.moveTo(230, 230);
  // ctx.lineTo(230 + 100, 230);
  // ctx.lineTo(230 + 100, 230 + 100);
  // ctx.lineTo(230, 230 + 100);
  // ctx.closePath();
  // ctx.fill();

  // æ¸…ç©ºæ‰€æœ‰å†…å®¹: è°ƒç”¨åä¸Šé¢ç»˜åˆ¶çš„å†…å®¹å…¨éƒ¨è¢«æ¸…é™¤
  const { width, height } = ctx.canvas;
  ctx.clearRect(0, 0, width, height);
};
```

## æ¸å˜è‰²

- [createLinearGradient](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/createLinearGradient) åˆ›å»ºçº¿æ€§æ¸å˜æ–¹æ¡ˆ(å¸¸ç”¨)
- [createRadialGradient](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/createRadialGradient) åˆ›å»ºå¾„å‘æ¸å˜æ–¹æ¡ˆ
- [createConicGradient](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/createConicGradient) åˆ›å»ºæ‰‡å½¢æ¸å˜æ–¹æ¡ˆ
- [CanvasGradient](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasGradient) æ¸å˜æ–¹æ¡ˆ

```js
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 500;
    canvasDom.height = 500;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");
  const ctx = canvasDom.getContext("2d");

  // åˆ›å»ºä¸€ä¸ªçº¿æ€§æ¸å˜ createLinearGradient(x1, y1, x2, y2)
  // x1, y1 å’Œ x2, y2 çš„åæ ‡å¯ä»¥æ„æˆä¸€æ¡çº¿, è¿™çº¿å°±æ˜¯æ¸å˜çš„æ–¹å‘
  // æ¸å˜èµ·ç‚¹: x1=10  y1=10
  // æ¸å˜ç»ˆç‚¹: x2=110 y2=10
  // ä¸ºä»€ä¹ˆæ˜¯ 10, 20, 110, 20 å› ä¸ºæ¸å˜æ–¹æ¡ˆä» 0 å¼€å§‹è®¡ç®—
  // å› ä¸ºçŸ©å½¢èµ·å§‹ç‚¹ç¦»å·¦è¾¹æœ‰ 10 åƒç´ æ‰€ä»¥éœ€è¦ çŸ©å½¢å®½åº¦ + 10
  // const gradient = ctx.createLinearGradient(10, 20, 110, 20); // ä»å·¦åˆ°å³æ¸å˜
  const gradient = ctx.createLinearGradient(10, 20, 110, 120); // ä»å·¦ä¸Šåˆ°å³ä¸‹æ¸å˜

  // æ·»åŠ è‰²æ ‡: addColorStop(progress, color)
  // progress æ˜¯ä¸€ä¸ªå€¼åœ¨ 0-1 è¡¨ç¤ºæ¸å˜è¿›åº¦
  // color    é¢œè‰²
  gradient.addColorStop(0, "#f00");
  gradient.addColorStop(0.5, "#0f0");
  gradient.addColorStop(1, "#00f");

  // å¡«å……çŸ©å½¢
  ctx.fillStyle = gradient;
  ctx.fillRect(10, 20, 100, 100);
};
```

## ç»˜åˆ¶åœ†å¼§

### åŸºç¡€çŸ¥è¯†äº†è§£

- è§’åº¦: ä¸€ä¸ªåœ† 360 åº¦(è§’åº¦), ä¸€ä¸ªåŠåœ†æ˜¯ 180 åº¦
- å¼§åº¦: ä¸€ä¸ªåœ† Ï€, ä¸€ä¸ªåŠåœ†æ˜¯ Ï€/2

```
è§’åº¦è½¬å¼§åº¦å…¬å¼:
  å› ä¸º: 180è§’åº¦ = Ï€ å¼§åº¦
  æ‰€ä»¥: 1è§’åº¦ = Ï€/180
  æ‰€ä»¥: å¼§åº¦ = è§’åº¦ * Ï€/180
        90è§’åº¦ * Ï€/180 = Ï€/2

å¼§åº¦è½¬è§’åº¦
  å› ä¸º: Ï€ å¼§åº¦ = 180è§’åº¦
  æ‰€ä»¥: 1 å¼§åº¦ = 180/Ï€
  æ‰€ä»¥: è§’åº¦ = å¼§åº¦ * 180/Ï€
       Ï€/2 * 180/Ï€ = 90 è§’åº¦
```

### ç»˜åˆ¶åœ†å½¢

```js
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 500;
    canvasDom.height = 500;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");
  const ctx = canvasDom.getContext("2d");

  // ctx.arc(x, y, round, startAngle, endAngle, isCounterclockwise);
  // x,y:        åœ†å¿ƒåæ ‡
  // round:      åŠå¾„
  // startAngle: èµ·å§‹è§’åº¦
  // endAngle:   ç»“æŸè§’åº¦
  // isCounterclockwise: æ˜¯å¦æ˜¯é€†æ—¶é’ˆæ–¹å‘ç»˜åˆ¶, é»˜è®¤false(é¡ºæ—¶é’ˆæ–¹å‘)

  ctx.arc(100, 100, 50, 0, Math.PI, false);
  ctx.strokeStyle = "#f00";
  ctx.stroke();

  // ä¸¤ä¸ªåŠåœ†, ä¸€ä¸ªé€†æ—¶é’ˆ, ä¸€ä¸ªé¡ºæ—¶é’ˆ, ç»„åˆæˆä¸€ä¸ªåœ†
  ctx.beginPath();
  ctx.arc(100, 100, 50, 0, Math.PI, true);
  ctx.strokeStyle = "#0f0";
  ctx.stroke();

  // ç›´æ¥ç»˜åˆ¶ä¸€ä¸ªåœ†å½¢
  ctx.beginPath();
  ctx.arc(200, 200, 50, 0, Math.PI * 2);
  ctx.strokeStyle = "#00f";
  ctx.stroke();
};
```

### ç»˜åˆ¶æ‰‡å½¢

æ‰€è°“æ‰‡å½¢, èµ·å§‹å°±æ˜¯å››åˆ†ä¹‹ä¸€çš„åœ†å½¢

```js
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 500;
    canvasDom.height = 500;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");
  const ctx = canvasDom.getContext("2d");

  ctx.moveTo(200, 200); // è®¾ç½®èµ·ç‚¹ä¸ºåœ†å¿ƒçš„åæ ‡ç‚¹
  ctx.arc(200, 200, 50, 0, Math.PI / 2);
  ctx.strokeStyle = "#00f";
  ctx.closePath(); // ç›´æ¥é—­åˆè·¯å¾„
  ctx.stroke();

  // ç¬¬äºŒä¸ªé€†æ—¶é’ˆæ‰‡å½¢:ä»360Â°(2Ï€)åˆ°270Â°(3Ï€/2), é€†æ—¶é’ˆç»˜åˆ¶90Â°æ‰‡å½¢
  ctx.beginPath();
  ctx.moveTo(200, 200);
  ctx.arc(200, 200, 50, Math.PI * 2, (Math.PI * 3) / 2, true);
  ctx.closePath(); // å›åˆ°åœ†å¿ƒï¼Œå½¢æˆæ‰‡å½¢åŒºåŸŸ
  ctx.strokeStyle = "#0f0";
  ctx.stroke();
};
```

### ç»˜åˆ¶é¥¼çŠ¶å›¾

æ‰€è°“çš„é¥¼çŠ¶å›¾èµ·å§‹å°±æ˜¯å¤šä¸ªæ‰‡å½¢ç»„åˆè€Œæˆ, ä»…æ­¤è€Œå·²

```js
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 500;
    canvasDom.height = 500;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");
  const ctx = canvasDom.getContext("2d");

  // è®¾å®šåœ†å¿ƒçš„ä½ç½®ä¸ºç”»å¸ƒçš„æ­£ä¸­é—´
  const rx = Math.floor(ctx.canvas.width / 2);
  const ry = Math.floor(ctx.canvas.height / 2);

  /*
  // 4 ç­‰åˆ†åœ†å½¢
  // 0-90
  ctx.moveTo(rx, ry);
  ctx.arc(rx, ry, 100, 0, Math.PI / 2);
  ctx.fillStyle = "#f00";
  ctx.fill();

  // 90-180
  ctx.beginPath()
  ctx.moveTo(rx, ry);
  ctx.arc(rx, ry, 100, Math.PI / 2, Math.PI);
  ctx.fillStyle = "#0f0";
  ctx.fill();

  // 180-270
  ctx.beginPath()
  ctx.moveTo(rx, ry);
  ctx.arc(rx, ry, 100, Math.PI, Math.PI + Math.PI / 2);
  ctx.fillStyle = "#00f";
  ctx.fill();

  // 270-360
  ctx.beginPath()
  ctx.moveTo(rx, ry);
  ctx.arc(rx, ry, 100, Math.PI + Math.PI / 2, Math.PI * 2);
  ctx.fillStyle = "#ff0";
  ctx.fill();
  */

  function randomColor() {
    return `#${Math.floor(Math.random() * 0xffffff).toString(16)}`;
  }

  let startAngle = 0;
  for (let i = 1; i <= 4; i++) {
    const endAngle = (i * Math.PI) / 2;
    ctx.beginPath();
    ctx.moveTo(rx, ry);
    ctx.arc(rx, ry, 100, startAngle, endAngle);
    ctx.fillStyle = randomColor();
    ctx.fill();
    ctx.closePath();
    startAngle = endAngle;
  }
};
```

![cookie](https://raw.githubusercontent.com/liaohui5/images/main/images/202511182337141.png)

## ç»˜åˆ¶æ–‡å­—

```js
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 500;
    canvasDom.height = 500;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");

  /** @type {CanvasRenderingContext2D} */
  const ctx = canvasDom.getContext("2d");

  const { width, height } = ctx.canvas;
  const halfWidth = Math.floor(width / 2);
  const halfHeight = Math.floor(height / 2);

  // å‚è€ƒåæ ‡çº¿
  ctx.moveTo(halfWidth, halfHeight);
  ctx.lineTo(0, halfHeight);
  ctx.lineTo(width, halfHeight);
  ctx.moveTo(halfWidth, halfHeight);
  ctx.lineTo(halfWidth, 0);
  ctx.lineTo(halfWidth, height);
  ctx.stroke();

  // ç»˜åˆ¶çŸ©å½¢: ä»¥çŸ©å½¢çš„å·¦ä¸Šè§’ä½œä¸ºå‚è€ƒåæ ‡
  // ç»˜åˆ¶æ–‡å­—: ä»¥æ–‡å­—çš„å·¦ä¸‹è§’ä½œä¸ºå‚è€ƒåæ ‡
  ctx.fillStyle = "#f00";
  ctx.fillRect(halfWidth, halfHeight, 100, 100);

  // è®¾ç½®æ–‡å­—çš„å¤§å°å’Œæ ·å¼
  ctx.font = "30px å¾®è½¯é›…é»‘";

  // è®¾ç½®æ–‡å­—å‚ç›´æ–¹å‘çš„å¯¹é½æ–¹å¼, ä»¥ç»˜åˆ¶æ–‡å­—çš„ Y åæ ‡ä½œä¸ºå‚è€ƒç‚¹
  ctx.textBaseline = "bottom"; // top/bottom/middle/alphabetic/ideographic

  // è®¾ç½®æ–‡å­—æ°´å¹³æ–¹å‘çš„å¯¹é½æ–¹å¼, ä»¥ç»˜åˆ¶æ–‡å­—çš„ X åæ ‡ä½œä¸ºå‚è€ƒç‚¹
  ctx.textAlign = "left"; // start/centerã€€/end/left/right

  // æ–‡å­—æè¾¹
  // ctx.strokeText("hello world", halfWidth, halfHeight);

  // å¡«å……æ–‡å­—(å®å¿ƒçš„)
  ctx.fillText("hello world", halfWidth, halfHeight);
};
```

![text](https://raw.githubusercontent.com/liaohui5/images/main/images/202511190019559.png)

## ç»˜åˆ¶å›¾ç‰‡

```js
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 600;
    canvasDom.height = 600;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");

  /** @type {CanvasRenderingContext2D} */
  const ctx = canvasDom.getContext("2d");

  const img = new Image();
  img.onload = function () {
    // å¦‚æœåªæœ‰ 3 ä¸ªå‚æ•°: drawImage(img, x, y)
    // img: æ˜¯éœ€è¦ç»˜åˆ¶çš„ å›¾ç‰‡
    // x,y: åé¢ä¸¤ä¸ªå‚æ•°å°±æ˜¯è®¾ç½®å›¾ç‰‡å¼€å§‹ç»˜åˆ¶çš„ä½ç½®(å›¾ç‰‡å·¦ä¸Šè§’)
    // ctx.drawImage(img, 10, 10);

    // å¦‚æœåªæœ‰ 5 ä¸ªå‚æ•°: drawImage(img, x, y, w, h)
    // img: æ˜¯éœ€è¦ç»˜åˆ¶çš„ å›¾ç‰‡
    // x,y: è®¾ç½®å›¾ç‰‡å¼€å§‹ç»˜åˆ¶çš„ä½ç½®(å›¾ç‰‡å·¦ä¸Šè§’)
    // w,h: è®¾ç½®ç»˜åˆ¶çš„å›¾ç‰‡çš„å®½åº¦/é«˜åº¦(ä¼šæ‹‰ä¼¸)
    // ctx.drawImage(img, 10, 10, 300, 100);

    // å¦‚æœæœ‰ 9 ä¸ªå‚æ•°: drawImage(img, imgX1, imgY1, imgX2, imgY2, x, y, w, h)
    // img: æ˜¯éœ€è¦ç»˜åˆ¶çš„å›¾ç‰‡(è¢«æˆªå–åçš„å›¾ç‰‡)
    // imgX1,imgY1: ä»¥åŸå›¾ç‰‡çš„å·¦ä¸Šè§’ä½œä¸ºå‚è€ƒ, è®¾ç½®æˆªå–çš„å¼€å§‹ä½ç½®
    // imgX2,imgY2: ä»¥åŸå›¾ç‰‡çš„å·¦ä¸Šè§’ä½œä¸ºå‚è€ƒ, è®¾ç½®æˆªå–çš„ç»“æŸä½ç½®
    // x,y: è®¾ç½®å›¾ç‰‡å¼€å§‹ç»˜åˆ¶çš„ä½ç½®(å›¾ç‰‡å·¦ä¸Šè§’)
    // w,h: è®¾ç½®ç»˜åˆ¶çš„å›¾ç‰‡çš„å®½åº¦/é«˜åº¦(ä¼šæ‹‰ä¼¸)
    ctx.drawImage(img, 10, 10, 150, 150, 100, 100, 120, 120);
  };
  img.src = "https://raw.githubusercontent.com/liaohui5/images/refs/heads/main/images/20220420132604.png";
};
```

![draw-image](https://raw.githubusercontent.com/liaohui5/images/main/images/202511190043582.png)

## å½¢å˜

- [translate](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/translate)
- [rotate](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/rotate)
- [scale](https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/scale)

canvas ä¸­ä¸ css çš„å½¢å˜ä¸åŒ, canvas ä¸­æ‰€æœ‰çš„å½¢å˜æ“ä½œ, éƒ½æ˜¯é’ˆå¯¹åæ ‡ç³», è€Œä¸æ˜¯ç»˜åˆ¶çš„å›¾å½¢

```js
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 600;
    canvasDom.height = 600;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");

  /** @type {CanvasRenderingContext2D} */
  const ctx = canvasDom.getContext("2d");

  // æ•´ä¸ªåæ ‡ç³»å‘ x,y ç§»åŠ¨ 100, è€Œä¸æ˜¯ç»˜åˆ¶çš„çŸ©å½¢ç§»åŠ¨
  ctx.translate(100, 100);

  ctx.fillStyle = "#f00";
  ctx.fillRect(50, 50, 100, 100);
  ctx.fillRect(0, 0, 10, 10);

  // å¦‚æœæ³¨é‡Šä¸Šé¢çš„ ctx.translate, æŠŠå½¢å˜çš„æ“ä½œæ”¾åˆ°
  // ç»˜åˆ¶å›¾å½¢çš„åé¢, å°±ä¼šå‘ç°çŸ©å½¢å¹¶ä¸ä¼šç§»åŠ¨
  // ctx.translate(100, 100);
};
```

![translate](https://raw.githubusercontent.com/liaohui5/images/main/images/202511190122120.png)

## å›¾å½¢äº¤äº’

é»˜è®¤æƒ…å†µä¸‹, JS æ— æ³•å’Œ canvas å†…ç»˜åˆ¶çš„å›¾å½¢è¿›è¡Œäº¤äº’,
ä½†æ˜¯å¯ä»¥ç”¨äº‹ä»¶è§¦å‘çš„ä½ç½®å’Œ canvas ç»˜åˆ¶çš„å›¾å½¢çš„ä½ç½®å»åˆ¤æ–­,
æ˜¯å¦ç‚¹å‡»äº†ç»˜åˆ¶çš„å›¾å½¢

```js
window.onload = function () {
  function initCanvasDom(id) {
    const canvasDom = document.getElementById(id);
    canvasDom.width = 600;
    canvasDom.height = 600;
    return canvasDom;
  }

  const canvasDom = initCanvasDom("app");

  /** @type {CanvasRenderingContext2D} */
  const ctx = canvasDom.getContext("2d");

  // rect1
  const rect = {
    x: 50,
    y: 50,
    width: 100,
    height: 100,
  };
  ctx.fillStyle = "#f00";
  ctx.rect(rect.x, rect.y, rect.width, rect.height);
  ctx.fill();

  // rect2
  // ctx.beginPath();
  ctx.rect(200, 200, 100, 100);
  ctx.fill();

  ctx.canvas.addEventListener("click", (e) => {
    // æ‰‹åŠ¨åˆ¤æ–­ä½ç½®
    const { offsetX, offsetY } = e;
    // const maxRectX = rect.x + rect.width;
    // const maxRectY = rect.y + rect.height;
    // if (offsetX >= rect.x && offsetX <= maxRectX && offsetY >= rect.y && offsetY <= maxRectY) {
    //   console.log("inside the rect");
    // } else {
    //   console.log("outside");
    // }

    // ä½¿ç”¨ isPointInPath æ–¹æ³•åˆ¤æ–­:
    // æ³¨æ„: é»˜è®¤æƒ…å†µä¸‹, rect1 rect2 éƒ½ä¼šè¿”å› true
    // ä½†æ˜¯å¦‚æœç»˜åˆ¶ rect2 æ—¶, å¼€å¯äº†æ–°è·¯å¾„ ctx.beginPath()
    // é‚£ä¹ˆå°±åªæœ‰ç‚¹å‡» rect2 ä¼šè¿”å› true, rect1 ä¼šè¿”å› false
    if (ctx.isPointInPath(offsetX, offsetY)) {
      console.log("inside the rect");
    } else {
      console.log("outside");
    }
  });
};
```

## å·§ç”¨ HTMLCanvasElement å®ä¾‹æ–¹æ³•

è¿™ä¸ªç±»é™¤äº† `getContent` æ–¹æ³•å¤–, è¿˜æœ‰å…¶ä»–ä¸¤ä¸ªæ–¹æ³•æ¯”è¾ƒå®ç”¨:

- [toBlob](https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLCanvasElement/toBlob) å°† HTMLCanvasElement
  å¯¹è±¡è½¬ä¸ºä¸€ä¸ª [Blob](https://developer.mozilla.org/zh-CN/docs/Web/API/Blob) å¯¹è±¡
- [toDataURL](https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLCanvasElement/toDataURL) å°†å›¾ç‰‡è½¬ base64 å­—ç¬¦ä¸²

### å‹ç¼©å›¾ç‰‡ä½“ç§¯: æ§åˆ¶å›¾ç‰‡çš„æ¸…æ™°åº¦

### æ ¹æ®åæ ‡è£å‰ªå›¾ç‰‡ç„¶åä¸Šä¼ 

## Canvas ç»ƒä¹ 

- [ ] å®ç°ä¸€ä¸ªç±»ä¼¼ windows paint çš„ç”»æ¿å·¥å…·
- [ ] åˆ®åˆ®ä¹ æ•ˆæœ
- [ ] bilibili å¼¹å¹•æ•ˆæœ
- [ ] ç½‘é¡µæˆªå›¾
- [ ] è´ªé£Ÿè›‡/äº”å­æ£‹
